<!doctype html>
<html lang="en-US">
<head>
    <title>AGDP</title>
    <style>
        body {
            background-image: url('../static/pics/bg.jpg');
            background-repeat: no-repeat;
            background-size: cover;
        }
        .modal-background {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50%;
            height: auto;
            padding: 6rem;
            z-index: 6;
            background-image: linear-gradient(to right, #8360c3, #2ebf91);
            filter: blur(50px);
            opacity: 0.5;
            overflow: hidden;
        }
    </style>
    <meta charset="UTF-8"/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
          type="text/css" media="all"/>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Amatic+SC%3A400%2C700%7CLato%3A400%2C700%2C400italic%2C700italic&amp;ver=4.9.8"
          type="text/css" media="screen"/>
    <link rel="stylesheet" href="../static/gamepage/style.css" type="text/css" media="screen"/>
    <link rel="stylesheet" href="../static/gamepage/print.css" type="text/css" media="print"/>
    <link rel="stylesheet" href="/static/confirm-pop-up/style.css">
    <!--[if (lt IE 9) & (!IEMobile)]>
    <link rel="stylesheet" id="lt-ie9-css" href="ie.css" type="text/css" media="screen"/>
    <![endif]-->
    <script src='../static/gamepage/js/jquery-3.0.0.min.js'></script>
    <script src='../static/gamepage/js/jquery-migrate-3.0.1.min.js'></script>

    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body class="home sticky-menu sidebar-off" id="top">

<header class="header">

    <div class="header-wrap">

        <div class="logo plain logo-left">
            <div class="site-title">
                <a href="market?con_id={{con_id}}" title="Go to Home">AGDP</a> <!--这里把链接换成返回主菜单的-->
            </div>
        </div><!-- /logo -->

    </div>

</header>


<div class="wrap full-wrap">
    <div class="main-wrap">
        <section class="main">


            <article class="post has-post-thumbnail">

  		        <span class="post-image">
                    <img width="916" height="611" src="/static/pics/{{id}}.jpg" alt="">
                    <!--更换这里的图片可以改主页面最大的那个图片-->
  		        </span>


                <div class="inner">

                    <h1 class="entry-title">{{name}}</h1> <!--这个地方改成游戏名-->
                    <ul class="meta top">
                        <li class="time">
                            <time class="post-date updated" datetime="2015-02-02">{{release_date}}</time><!--这里改成发行的时间-->
                        </li>
                        <li class="author-m">
                            Publisher: <span class="vcard author"><span class="fn">{{pub_name}}</a></span></span>
                        </li><!--这里改成发行公司的名字-->
                        <li class="author-m">
                            Developer:
                            {% for dev in dev_name%}
                            <span class="vcard author"><span class="fn">{{dev}}</a></span></span>
                            {% endfor %}
                        </li><!--这里改成开发公司的名字-->

                    </ul>
                    <div class="post-content">
                        <blockquote><p>“You are lucky!!!This fun game is on sale at a lower price!!!”<cite>Price: {{price}}$</cite></p>
                            <div class="btn">
                                <button type="submit" id="purchase">Purchase</button>
                            </div>
                        </blockquote><!--这里换成price-->
                    </div>

                    <ul class="meta bottom">
                        
                        <li class="cat">TAGS of this game:</li> <!--这里换成游戏的tags-->
                        
                    </ul>
                    <ul class="meta bottom">
                        {% for tag in tags%}
                        <li class="cat">{{tag}}</li> <!--这里换成游戏的tags-->
                        {% endfor %}
                    </ul>
                    <div class="post-content">
                        <blockquote><p>Rating this game:
                            <div class="container">
                                <div class="star-widget">
                                    <input type="radio" name="rate" id="rate-5">
                                    <label for="rate-5">terrible</label>
                                    <input type="radio" name="rate" id="rate-4">
                                    <label for="rate-4">bad</label>
                                    <input type="radio" name="rate" id="rate-3">
                                    <label for="rate-3">average</label>
                                    <input type="radio" name="rate" id="rate-2">
                                    <label for="rate-2">good</label>
                                    <input type="radio" name="rate" id="rate-1">
                                    <label for="rate-1">excellent</label>
                                    <form action="#">
                                        <div class="btn">
                                            <button type="submit">Post</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </blockquote>
                    </div>

                </div>





            <div class="related-posts">

                <h5>Same tag games</h5>

                <div class="posts">

                    
                    {% for recommand in recommands %}
                    <aside class="related post has-post-thumbnail">

  		                <span class="post-image">
                            <a href="/game?game_id={{recommand[0]}}" title="The Apothecary">
                                <img width="468" height="468" src="/static/pics/{{recommand[0]}}.jpg" alt=""></a><!--更换成正确的图片-->
                        </span>


                        <div class="inner">

                            <h6 class="entry-title">

                                <a href="/game?game_id={{recommand[0]}}" title="The Apothecary">
                                    {{recommand[1]}}  <!--这里改成游戏的名字和对应的游戏链接-->
                                </a>
                                <ul class="meta top">
                                    <li class="time">
                                        <time class="price">Price: {{recommand[2]}}$</time> <!--这里改成游戏对应的价钱-->
                                    </li>
                                </ul>

                            </h6>

                        </div>
                    </aside>
                    {% endfor %}


                </div></div>

                <div class="Recruiting a Publisher">

                    <div id="comments" class="inner">
    
                        <div class="comments-inner"><h3 id="respond-title">JOIN US?</h3></div>
    
                        <aside class="comments">
                        </aside>
    
                        <div id="respond" class="comment-respond">
                            <h3 id="reply-title" class="comment-reply-title">Leave the information of your game <small><a rel="nofollow" id="cancel-comment-reply-link" href="#respond" style="display:none;">Cancel reply</a></small></h3>
                            <form class="game-upload"  action="/publisher/add-game" enctype="multipart/form-data" method="post" onsubmit="return validate()">
                            <!-- <form class="game-upload"  action="/publisher/add-game" method="post" onsubmit="return validate()"> -->
                                <p><label for="url">Game Name</label><input id="game_name" name="game_name" type="text" value="" size="30" placeholder="Game Name"></p>    
                                <p><label for="url">Developer</label><input id="dev_name" name="dev_name" type="text" value="" size="30" placeholder="Developer"></p>
                                <p><label for="url">Publisher</label><input id="pub_name" name="pub_name" type="text" value="" size="30" placeholder="Publisher"></p>
                                <p><label for="url">Price($)</label><input id="price" name="price" type="text" value="" size="30" placeholder="Price"></p>
                                <p><label for="url">Release time</label><input id="date" name="date" type="text" value="" size="30" placeholder="Release time"></p>
                                <p><label for="url">TAGS</label><input id="tags" name="tags" type="text" value="" size="30" placeholder="TAGS"></p>
                                <!-- <p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="join us"></p> -->

                            <h4 id="reply-title" class="comment-reply-title">You need to offer one game photo: <small><a rel="nofollow" id="cancel-comment-reply-link" href="#respond" style="display:none;">Cancel reply</a></small></h4>
                            

                                <p>
                                <label for="url">photo</label>
                                <input id="file" name="file" type="file" value="" size="30" placeholder="photo"/>
                                <button type="submit">Join Us</button>
                            </p> 
                            </form>

                        </div><!-- #respond -->
    
                    </div>
    
                </div>
               


        </section>


    </div><!-- /main-wrap -->
        <!-- pop up window -->
        <div class="modal-confirm" style="display: none" id="success">
            <a class="close-button">&times;</a>
    
            <div class="check" style="position: absolute; top:50%">
                <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
        viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">
            <circle style="fill:#25AE88;" cx="25" cy="25" r="25"/>
            <polyline style="fill:none;stroke:#FFFFFF;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;" points="
            38,15 22,33 12,25 "/>
        </svg>
    
    
        </div>
        <div class="prompt">
            Purchase Completed!
        </div>
        </div>
    
        <div class="modal-confirm" style="display: none" id="failure">
            <button class="close-button">&times;</button>
    
            <div class="check" style="position: absolute; top:50%">
              <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
              viewBox="0 0 511.999 511.999" style="enable-background:new 0 0 511.999 511.999;" xml:space="preserve">
           <path style="fill:#FF6465;" d="M384.955,256l120.28-120.28c9.019-9.019,9.019-23.642,0-32.66L408.94,6.765
             c-9.019-9.019-23.642-9.019-32.66,0l-120.28,120.28L135.718,6.765c-9.019-9.019-23.642-9.019-32.66,0L6.764,103.058
             c-9.019,9.019-9.019,23.642,0,32.66l120.28,120.28L6.764,376.28c-9.019,9.019-9.019,23.642,0,32.66l96.295,96.294
             c9.019,9.019,23.642,9.019,32.66,0l120.28-120.28l120.28,120.28c9.019,9.019,23.642,9.019,32.66,0l96.295-96.294
             c9.019-9.019,9.019-23.642,0-32.66L384.955,256z"/>
           </svg>       
    
    
        </div>
        <div class="prompt">
    
        </div>
        </div>


</div><!-- /wrap -->



<script>var ie9 = false;</script>
<!--[if lte IE 9 ]>
<script> var ie9 = true; </script>
<![endif]-->
<script src="../static/gamepage/js/global-plugins.min.js"></script>
<script src="../static/gamepage/js/main.js"></script>


<!-- game upload form validation -->
<script>
    function validate(){
        var game_name = $('#game_name').val().length;
        var dev_name = $('#dev_name').val().length;
        var pub_name = $('#pub_name').val().length;
        var price = $('#price').val().length;
        var tags = $('#tags').length;

        if (game_name == 0 | dev_name == 0 | pub_name == 0 | price == 0 | tags == 0){
            alert('Form Incompete!');
            return false;
        }
        if ($('#file')[0].files.length == 0){
            alert('You should upload a picture of the game to be uploaded!');
            return false;
        }
        $('#date').attr('disabled', false);
        return true;
    };
</script>

<script>
    $('#date').ready(function(){
        var today = new Date();
        var dd = String(today.getDate()).padStart(2, '0');
        var mm = String(today.getMonth()+1).padStart(2, '0');
        var yyyy = today.getFullYear();

        today = mm + '/' + dd + '/' + yyyy;
        $('#date').val(today);
        $('#date').attr('disabled', true);
    })
</script>


<!-- listen on purchase button -->
<script>
    $('#purchase').click(function(){
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);

        var con_id  = urlParams.get('con_id');
        var game_id = urlParams.get('game_id');

        var today = new Date();
        var dd = String(today.getDate()).padStart(2, '0');
        var mm = String(today.getMonth()+1).padStart(2, '0');
        var yyyy = today.getFullYear();

        today = mm + '/' + dd + '/' + yyyy;

        $.ajax({
                url : '/consumer/purchase',
                type: 'POST',
                dataType: 'json',
                data: jQuery.param({
                    game_id : game_id,
                    con_id : con_id, 
                    date: today
                }),
                success: function(response){
                    var state = response.state;

                    if(state == 'successful'){
                        $('#success .prompt').empty().append('Purchase Completed!');
                        $('#success').css('display', 'block');
                    }
                    else if(state == 'duplicate'){
                        $('#failure .prompt').empty().append('You\'ve Owned This Game!');
                        $('#failure').css('display', 'block');

                    }
                }
            })

    });
</script>

<script>
    $('.modal-confirm .close-button').click(function(e){
      e.stopPropagation();
      $('.modal-confirm').css('display', 'none');
    });
</script>


</body>
</html>

